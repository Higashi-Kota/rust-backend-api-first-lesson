# エンドポイント一覧

この task-backend API で提供される全エンドポイントの機能別ドキュメントです。

## 📚 機能別ドキュメント

### 🔐 [認証（Authentication）](./authentication.md)
ユーザー登録、ログイン、トークン管理など認証関連の機能
- ユーザー登録・ログイン・ログアウト
- パスワードリセット・変更
- JWT アクセストークンとリフレッシュトークン管理
- メール認証・再送機能
- アカウント削除・全デバイスログアウト

### 👤 [ユーザー管理](./user_management.md)
ユーザープロフィール管理、設定変更、統計情報
- プロフィール情報の取得・更新
- メールアドレス・ユーザー名変更
- メール認証・ユーザー設定
- 管理者用高度ユーザー検索・分析
- サブスクリプション別ユーザー管理
- 一括ユーザー操作

### 📋 [タスク管理](./task_management.md)
タスクのCRUD操作、フィルタリング、一括操作
- 基本的なタスクCRUD操作
- 動的パーミッション付きタスク操作
- フィルタリング・ページネーション
- 一括操作（作成・更新・削除・ステータス変更）
- 管理者用高度タスク管理・統計分析

### 🎭 [ロール管理](./role_management.md)
システム内のロール（役割）管理とユーザーへの割り当て
- ロールのCRUD操作（管理者専用）
- パーミッション設定
- ユーザーへのロール割り当て
- 動的パーミッションシステムとの連携

### 👥 [チーム管理](./team_management.md)
チームの作成、管理、メンバー招待・管理
- チームのCRUD操作
- メンバー招待・役割管理
- チーム統計情報
- Pro階層以上で利用可能

### 🏢 [組織管理](./organization_management.md)
大規模組織での複数チーム統括管理
- 組織のCRUD操作
- メンバー・チーム管理
- 組織設定・統計
- Enterprise階層専用機能

### 🏗️ [組織階層・部門管理](./organization_hierarchy.md)
組織内の部門管理と階層構造
- 部門のCRUD操作
- 部門メンバー管理
- 組織階層の可視化
- パーミッション・マトリックス設定
- 組織データエクスポート

### 💳 [サブスクリプション管理](./subscription_management.md)
Free/Pro/Enterpriseの階層管理とアップグレード・ダウングレード
- 現在のサブスクリプション情報取得
- プランのアップグレード・ダウングレード
- 履歴管理・統計
- 管理者用サブスクリプション操作

### 🔑 [権限管理](./permission_management.md)
動的パーミッションシステムの権限チェックと機能アクセス管理
- リアルタイム権限チェック
- 一括権限検証
- 機能アクセス管理
- サブスクリプション階層との連携

### 📊 [アナリティクス・統計](./analytics.md)
システム利用統計、ユーザー行動分析、パフォーマンス指標
- 個人アクティビティ統計
- タスク分析・行動パターン分析
- 高度なエクスポート機能
- 管理者用システム統計・ユーザー行動分析

### 🛡️ [セキュリティ管理](./security.md)
システムセキュリティの監視と管理
- トークン・セッション監視
- パスワードリセット分析
- セキュリティ監査レポート
- 不正アクセス対策（管理者専用）

### 🔧 [管理者機能](./admin.md)
管理者専用の高度な管理機能
- タスク・ユーザー・チーム一括管理
- システム統計・監視
- 招待・トークン・セキュリティ管理
- データエクスポート・分析機能

### 🌐 [パブリック機能](./public.md)
認証不要でアクセス可能な基本情報とヘルスチェック
- API基本情報
- システムヘルスチェック
- パブリック統計情報
- 監視・運用支援機能

## 🎯 動的パーミッションシステム

このAPIの最大の特徴は **動的パーミッションシステム** です。ユーザーのサブスクリプション階層（Free/Pro/Enterprise）と役割（admin/user）によって、同一エンドポイントでも異なる機能やデータアクセス範囲を提供します。

### サブスクリプション階層別機能

| 機能 | Free | Pro | Enterprise |
|------|------|-----|------------|
| タスク数上限 | 100件 | 10,000件 | 無制限 |
| チーム機能 | ❌ | ✅ (最大3チーム) | ✅ (無制限) |
| 組織機能 | ❌ | ❌ | ✅ (無制限) |
| 部門・階層管理 | ❌ | ❌ | ✅ (無制限) |
| 高度な分析 | ❌ | ✅ | ✅ |
| データエクスポート | ❌ | ✅ | ✅ |
| API統合 | ❌ | 制限付き | ✅ |
| 一括操作 | 制限付き | ✅ | ✅ (高度) |
| セキュリティ監視 | ❌ | 基本 | ✅ (高度) |

### 動的エンドポイントの例

```bash
# 同じエンドポイントが、ユーザーにより異なる動作
GET /tasks/dynamic

# Freeユーザー: 最大100件、基本機能のみ
# Proユーザー: 最大10,000件、高度なフィルタ・エクスポート可能
# Enterpriseユーザー: 無制限、すべての機能利用可能
```

## 🔒 認証方式

すべての保護されたエンドポイントは JWT 認証を使用します：

```bash
# Authorization ヘッダー（推奨）
curl -H "Authorization: Bearer <access_token>" <endpoint>

# httpOnly クッキー
curl -H "Cookie: access_token=<access_token>" <endpoint>
```

## ⚡ パフォーマンス最適化

- **動的権限チェック**: 15ms 以下の高速処理
- **権限結果キャッシュ**: 85% 以上のキャッシュヒット率
- **一括操作対応**: 最大100件の同時処理
- **ページネーション**: 効率的な大量データ処理

## 🛠️ 開発者サポート

### 共通レスポンス形式

#### 成功レスポンス
```json
{
  "data": { /* レスポンスデータ */ },
  "pagination": { /* ページネーション情報（該当時） */ }
}
```

#### エラーレスポンス
```json
{
  "error": "Error message",
  "error_type": "error_category",
  "details": { /* 追加情報 */ }
}
```

### よくあるHTTPステータスコード

- `200 OK`: 成功
- `201 Created`: 作成成功
- `204 No Content`: 削除成功
- `400 Bad Request`: リクエストエラー
- `401 Unauthorized`: 認証エラー
- `403 Forbidden`: 権限エラー
- `402 Payment Required`: サブスクリプション制限
- `404 Not Found`: リソースなし
- `429 Too Many Requests`: レート制限
- `500 Internal Server Error`: サーバーエラー

## 📞 サポート

- **ドキュメント**: `/docs/endpoints/`
- **API仕様**: 実装予定  
- **ヘルスチェック**: `/health`、各サービス専用エンドポイント
- **システム監視**: 管理者用セキュリティ・分析エンドポイント

各機能の詳細については、上記のリンクから該当するドキュメントを参照してください。