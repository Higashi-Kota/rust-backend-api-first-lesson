# ✅ Rust ライブラリアップデート実践ガイド

## 🔰 基本方針

Rust プロジェクトで依存ライブラリ（crate）を更新する際は、以下の流れを原則とします：

> **編集 → 反映 → 確認 → 記録**

---

## 🧭 アップデート手順まとめ

### ① 依存状況の把握（現在の状態を確認）

```bash
cargo tree --edges=all
```

---

### ② ライブラリ更新の方法

#### ✅ すべてのライブラリを最新にする

```bash
cargo update
```

#### ✅ 特定のライブラリだけ更新する

```bash
cargo update -p crate名
```

---

### ③ 手動で `Cargo.toml` を編集した場合の対処

#### 🔁 ワークフロー：

1. `Cargo.toml` のバージョンを更新（例：`tokio = "1.38.0"`）
2. 以下を実行して `Cargo.lock` に反映：

```bash
cargo update -p tokio
```

または全体更新：

```bash
cargo update
```

3. 動作確認：

```bash
cargo build
cargo test
```

---

### ④ 想定通りに更新されないときのワークアラウンド

| 症状                                               | 対策                                                 |
| -------------------------------------------------- | ---------------------------------------------------- |
| lock ファイルが更新されない                        | `cargo update` または `cargo update -p crate名` 実行 |
| バージョン範囲が狭く、意図のバージョンに上がらない | `Cargo.toml` に明示的なバージョン指定を記述          |
| キャッシュが悪さしている                           | `cargo clean && cargo build`                         |
| 強制的に全再構築したい                             | `rm Cargo.lock && cargo build`                       |

---

### ⑤ バージョン固定（必要に応じて）

```toml
# 絶対にこのバージョンを使いたいとき
serde = "=1.0.197"
```
