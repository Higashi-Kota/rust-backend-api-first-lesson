# Rust Backend API - Feature-based Architecture

## ğŸ“Œ ç¾åœ¨ã®çŠ¶æ…‹ (2025-07-11)

**Phase 21 å®Œäº†** - æ–°è¦Featureä½œæˆå®Œäº† âœ…
- Phase 19å®Œäº†: å…¨ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹é”æˆ (523/523 ãƒ‘ã‚¹ã€6 ignored)
- Phase 20éƒ¨åˆ†å®Œäº†:
  - âœ… ç©ºã®å†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼å‰Šé™¤å®Œäº†
  - âœ… api/dtoãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå®Œå…¨å‰Šé™¤
  - âœ… ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹æ›´æ–°å®Œäº†
  - âœ… paymenté–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œå®Œäº†
  - â³ ä»–ã®ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ãƒ»ãƒªãƒã‚¸ãƒˆãƒªãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®ç§»è¡Œã¯æœªç€æ‰‹
- Phase 21å®Œäº†:
  - âœ… features/payment/ ä½œæˆï¼ˆDTOã‚’å«ã‚€å®Œå…¨ãªæ§‹é€ ï¼‰
  - âœ… features/user/ ä½œæˆï¼ˆã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ã¿ï¼‰
  - âœ… features/system/ ä½œæˆï¼ˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ã¿ï¼‰
  - âœ… å…¨ãƒ†ã‚¹ãƒˆã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹æ›´æ–°
  - âœ… ãƒ“ãƒ«ãƒ‰æˆåŠŸï¼ˆã‚¨ãƒ©ãƒ¼ãƒ»è­¦å‘Šãªã—ï¼‰

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### ç¾åœ¨ã®æ§‹é€ 
```
src/
â”œâ”€â”€ features/          # æ©Ÿèƒ½åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ auth/         # èªè¨¼ãƒ»èªå¯
â”‚   â”œâ”€â”€ task/         # ã‚¿ã‚¹ã‚¯ç®¡ç†
â”‚   â”œâ”€â”€ team/         # ãƒãƒ¼ãƒ ç®¡ç†
â”‚   â”œâ”€â”€ organization/ # çµ„ç¹”ç®¡ç†
â”‚   â”œâ”€â”€ storage/      # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ gdpr/         # GDPRå¯¾å¿œ
â”‚   â”œâ”€â”€ security/     # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ admin/        # ç®¡ç†è€…æ©Ÿèƒ½
â”‚   â”œâ”€â”€ analytics/    # åˆ†ææ©Ÿèƒ½
â”‚   â”œâ”€â”€ subscription/ # ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ payment/      # æ”¯æ‰•ã„å‡¦ç† (Phase 21ã§è¿½åŠ )
â”‚   â”œâ”€â”€ user/         # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† (Phase 21ã§è¿½åŠ )
â”‚   â””â”€â”€ system/       # ã‚·ã‚¹ãƒ†ãƒ æ©Ÿèƒ½ (Phase 21ã§è¿½åŠ )
â”œâ”€â”€ api/              # ãƒ¬ã‚¬ã‚·ãƒ¼APIå±¤ï¼ˆæ®µéšçš„ã«å‰Šé™¤äºˆå®šï¼‰
â”œâ”€â”€ domain/           # ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆæ®µéšçš„ã«å‰Šé™¤äºˆå®šï¼‰
â”œâ”€â”€ repository/       # ãƒ¬ã‚¬ã‚·ãƒ¼ãƒªãƒã‚¸ãƒˆãƒªå±¤ï¼ˆæ®µéšçš„ã«å‰Šé™¤äºˆå®šï¼‰
â”œâ”€â”€ service/          # ãƒ¬ã‚¬ã‚·ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹å±¤ï¼ˆæ®µéšçš„ã«å‰Šé™¤äºˆå®šï¼‰
â”œâ”€â”€ shared/           # å…±é€šå‹ãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ infrastructure/   # æŠ€è¡“åŸºç›¤
â””â”€â”€ main.rs
```

### Feature ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¨™æº–æ§‹é€ 
```
features/{feature_name}/
â”œâ”€â”€ mod.rs           # å…¬é–‹APIå®šç¾©
â”œâ”€â”€ handlers/        # HTTPãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”œâ”€â”€ services/        # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ repositories/    # ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
â”œâ”€â”€ models/          # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ dto/             # ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ requests/    # ãƒªã‚¯ã‚¨ã‚¹ãƒˆDTO
â”‚   â””â”€â”€ responses/   # ãƒ¬ã‚¹ãƒãƒ³ã‚¹DTO
â””â”€â”€ usecases/        # è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

## ğŸ“‹ æ®‹ã‚¿ã‚¹ã‚¯ä¸€è¦§

### Phase 20: ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ã®å®Œå…¨å‰Šé™¤
**ç›®çš„**: å†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«ã‚ˆã‚‹æš«å®šå¯¾å¿œã‚’è§£æ¶ˆã—ã€å…¨ã‚³ãƒ¼ãƒ‰ã‚’é©åˆ‡ãªå ´æ‰€ã«é…ç½®

#### å®Œäº†ã‚¿ã‚¹ã‚¯ âœ…
1. **ç©ºã®å†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼å‰Šé™¤**
   - `task-backend/src/api/handlers/analytics_handler.rs` å‰Šé™¤æ¸ˆã¿
   - `task-backend/src/api/handlers/subscription_handler.rs` å‰Šé™¤æ¸ˆã¿
   - `task-backend/src/api/handlers/mod.rs` æ›´æ–°æ¸ˆã¿

2. **api/dtoãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å®Œå…¨å‰Šé™¤**
   - `task-backend/src/api/dto/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…¨ä½“å‰Šé™¤æ¸ˆã¿
   - `role_dto.rs` â†’ `features/security/dto/legacy/role_dto.rs` ç§»è¡Œæ¸ˆã¿
   - `api/mod.rs` ã‹ã‚‰ dto ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‚ç…§å‰Šé™¤æ¸ˆã¿

3. **ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹æ›´æ–°**
   - `api::dto::common::*` â†’ `shared::types::common::*`
   - `api::dto::user_dto::*` â†’ `shared::dto::user::*`
   - `api::dto::role_dto::*` â†’ `features/security/dto/legacy/role_dto::*`
   - ãã®ä»–å…¨ã¦ã®DTOå‚ç…§ã‚’é©åˆ‡ãªfeatureãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«æ›´æ–°æ¸ˆã¿

4. **paymenté–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œ**
   - `domain/stripe_payment_history_model.rs` â†’ `features/payment/models/stripe_payment_history.rs` ç§»è¡Œæ¸ˆã¿
   - `repository/stripe_payment_history_repository.rs` â†’ `features/payment/repositories/` ç§»è¡Œæ¸ˆã¿
   - `service/payment_service.rs` â†’ `features/payment/services/` ç§»è¡Œæ¸ˆã¿
   - `api/handlers/payment_handler.rs` â†’ `features/payment/handlers/` ç§»è¡Œæ¸ˆã¿

#### æ®‹ã‚¿ã‚¹ã‚¯ â³
1. **ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œ**ï¼ˆç¾åœ¨19ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
   - organization, team, user, role, securityé–¢é€£ãƒ¢ãƒ‡ãƒ«ã‚’é©åˆ‡ãªfeatureã¸

2. **ãƒ¬ã‚¬ã‚·ãƒ¼ãƒªãƒã‚¸ãƒˆãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œ**ï¼ˆç¾åœ¨14ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
   - organization, team, role, securityé–¢é€£ãƒªãƒã‚¸ãƒˆãƒªã‚’é©åˆ‡ãªfeatureã¸

3. **ãƒ¬ã‚¬ã‚·ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œ**ï¼ˆç¾åœ¨9ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
   - organization, team, role, securityé–¢é€£ã‚µãƒ¼ãƒ“ã‚¹ã‚’é©åˆ‡ãªfeatureã¸

### Phase 21: æœªç§»è¡Œæ©Ÿèƒ½ã®FeatureåŒ– âœ… å®Œäº†
**ç›®çš„**: æ®‹ã‚Šã®æ©Ÿèƒ½ã‚’ç‹¬ç«‹ã—ãŸfeatureãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å®Ÿè£…

#### å®Œäº†ã‚¿ã‚¹ã‚¯ âœ…
1. **features/payment/** 
   - âœ… `api/handlers/payment_handler.rs` â†’ `features/payment/handlers/` ç§»è¡Œæ¸ˆã¿
   - âœ… `service/payment_service.rs` â†’ `features/payment/services/` ç§»è¡Œæ¸ˆã¿
   - âœ… `domain/stripe_payment_history_model.rs` â†’ `features/payment/models/` ç§»è¡Œæ¸ˆã¿
   - âœ… `repository/stripe_payment_history_repository.rs` â†’ `features/payment/repositories/` ç§»è¡Œæ¸ˆã¿
   - âœ… DTOã®æ•´ç†: `dto/requests/`, `dto/responses/` æ§‹é€ ã§å®Ÿè£…æ¸ˆã¿
   - âœ… Stripeçµ±åˆãƒ­ã‚¸ãƒƒã‚¯ã®æ•´ç†å®Œäº†

2. **features/user/**
   - âœ… `api/handlers/user_handler.rs` â†’ `features/user/handlers/` ç§»è¡Œæ¸ˆã¿
   - âœ… `service/user_service.rs` â†’ `features/user/services/` ç§»è¡Œæ¸ˆã¿
   - â³ DTOã®æ•´ç†ã¯æœªå®Ÿè£…ï¼ˆç¾åœ¨ã¯shared/dto/userã‚’ä½¿ç”¨ï¼‰
   - â³ ãƒªãƒã‚¸ãƒˆãƒªãƒ»ãƒ¢ãƒ‡ãƒ«ã®ç§»è¡Œã¯æœªå®Ÿè£…

3. **features/system/**
   - âœ… `api/handlers/system_handler.rs` â†’ `features/system/handlers/` ç§»è¡Œæ¸ˆã¿
   - â³ ã‚µãƒ¼ãƒ“ã‚¹å±¤ã®å®Ÿè£…ã¯æœªå®Ÿè£…ï¼ˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‹ã‚‰ç›´æ¥å®Ÿè£…ï¼‰

#### Phase 21 æ®‹èª²é¡Œ
1. **features/user/ã®å®Œå…¨åŒ–**
   - `domain/user_model.rs` â†’ `features/user/models/` ã¸ã®ç§»è¡Œ
   - UserRepositoryã®`features/user/repositories/`ã¸ã®ç§»è¡Œï¼ˆç¾åœ¨authé…ä¸‹ï¼‰
   - DTOã®æ•´ç†: `shared/dto/user/` â†’ `features/user/dto/` ã¸ã®ç§»è¡Œ
   - UserSettingsã‚µãƒ¼ãƒ“ã‚¹ã®çµ±åˆ

2. **features/system/ã®å®Œå…¨åŒ–**
   - ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã®ä½œæˆ
   - ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ã‚µãƒ¼ãƒ“ã‚¹ã®å®Ÿè£…
   - DTOã®æ•´ç†ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

### Phase 22: æ®‹èª²é¡Œã®è§£æ¶ˆ
**ç›®çš„**: Phase 20-21ã§ç©ã¿æ®‹ã—ãŸç§»è¡Œä½œæ¥­ã¨æ©Ÿèƒ½ã®å®Œå…¨å®Ÿè£…

#### ã‚¿ã‚¹ã‚¯
1. **Phase 20æ®‹ä½œæ¥­ã®å®Œäº†**
   - ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ19ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®é©åˆ‡ãªfeatureã¸ã®ç§»è¡Œ
   - ãƒ¬ã‚¬ã‚·ãƒ¼ãƒªãƒã‚¸ãƒˆãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ14ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®é©åˆ‡ãªfeatureã¸ã®ç§»è¡Œ
   - ãƒ¬ã‚¬ã‚·ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ9ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®é©åˆ‡ãªfeatureã¸ã®ç§»è¡Œ
   - `api/handlers/`å†…ã®æ®‹ã‚Šãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®ç§»è¡Œ
   - ç©ºã«ãªã£ãŸãƒ¬ã‚¬ã‚·ãƒ¼ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤

2. **Phase 21æ®‹èª²é¡Œã®è§£æ¶ˆ**
   - **features/user/ã®å®Œå…¨åŒ–**
     - `domain/user_model.rs` â†’ `features/user/models/`
     - UserRepositoryã‚’`features/auth/`ã‹ã‚‰`features/user/repositories/`ã¸
     - `shared/dto/user/` â†’ `features/user/dto/`ã¸ã®æ§‹é€ åŒ–
     - UserSettingsã‚µãƒ¼ãƒ“ã‚¹ã®çµ±åˆ
   - **features/system/ã®å®Œå…¨åŒ–**
     - ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã®ä½œæˆ
     - ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ã‚µãƒ¼ãƒ“ã‚¹ã®å®Ÿè£…
     - å¿…è¦ã«å¿œã˜ãŸDTOã®æ•´ç†

3. **æ—¢å­˜featureã®æ§‹é€ è£œå®Œ**
   - ä¸å®Œå…¨ãªæ§‹é€ ã®featureã«models/repositories/dtoç­‰ã‚’è¿½åŠ 
   - å†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®æ•´ç†ã¨æœ€é©åŒ–

### Phase 23: å“è³ªæ”¹å–„
**ç›®çš„**: ã‚³ãƒ¼ãƒ‰å“è³ªã¨ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®å‘ä¸Š

#### ã‚¿ã‚¹ã‚¯
1. **Ignoredãƒ†ã‚¹ãƒˆã®ä¿®æ­£** (6ä»¶)
   - Admin settingså‰Šé™¤ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®Ÿè£…
   - Feature usage trackingæ©Ÿèƒ½ã®å®Œå…¨å®Ÿè£…

2. **Dead Codeå‰Šé™¤** (ç´„70ç®‡æ‰€)
   - `#[allow(dead_code)]` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®é™¤å»
   - æœªä½¿ç”¨é–¢æ•°ãƒ»æ§‹é€ ä½“ã®å‰Šé™¤

3. **DTOã®ä¸€è²«æ€§ç¢ºä¿**
   - å…¨featureã§requests/responsesæ§‹é€ ã‚’çµ±ä¸€
   - ã‚°ãƒ­ãƒ–ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’æ˜ç¤ºçš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤‰æ›´

### Phase 24: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æº–å‚™
**ç›®çš„**: ãƒãƒ«ãƒã‚¯ãƒ¬ãƒ¼ãƒˆæ§‹æˆã¸ã®ç§»è¡Œæº–å‚™

#### ã‚¿ã‚¹ã‚¯
1. **ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆã¸ã®æ®µéšçš„ç§»è¡Œ**
   - Cargo.tomlã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹è¨­å®šè¿½åŠ 
   - å„featureã®ç‹¬ç«‹æ€§ç¢ºèªã¨ã‚¯ãƒ¬ãƒ¼ãƒˆåˆ†é›¢æº–å‚™
   - ä¾å­˜é–¢ä¿‚ã®æ•´ç†ã¨æœ€é©åŒ–

2. **æœ€çµ‚æ§‹é€ ã¸ã®ç§»è¡Œæº–å‚™**
   ```
   rust-backend-api/
   â”œâ”€â”€ Cargo.toml          # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å®šç¾©
   â”œâ”€â”€ crates/
   â”‚   â”œâ”€â”€ shared/         # å…±é€šå‹ãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
   â”‚   â”œâ”€â”€ core/           # ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³
   â”‚   â”œâ”€â”€ infrastructure/ # æŠ€è¡“åŸºç›¤
   â”‚   â”œâ”€â”€ feature-auth/   # èªè¨¼æ©Ÿèƒ½
   â”‚   â”œâ”€â”€ feature-task/   # ã‚¿ã‚¹ã‚¯ç®¡ç†
   â”‚   â”œâ”€â”€ feature-team/   # ãƒãƒ¼ãƒ ç®¡ç†
   â”‚   â”œâ”€â”€ feature-org/    # çµ„ç¹”ç®¡ç†
   â”‚   â””â”€â”€ ...            # ä»–ã®featureã‚¯ãƒ¬ãƒ¼ãƒˆ
   â””â”€â”€ apps/
       â”œâ”€â”€ api-server/     # ãƒ¡ã‚¤ãƒ³APIã‚µãƒ¼ãƒãƒ¼
       â””â”€â”€ worker/         # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¯ãƒ¼ã‚«ãƒ¼
   ```

3. **ç§»è¡Œè¨ˆç”»ã®ç­–å®š**
   - å„featureã®ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—ä½œæˆ
   - ç§»è¡Œé †åºã®æ±ºå®š
   - ãƒªã‚¹ã‚¯è©•ä¾¡ã¨ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

è¨­è¨ˆåŸå‰‡ã€å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã€å„Phaseã®è©³ç´°ãªå®Ÿè£…æ‰‹é †ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

- **[è¨­è¨ˆåŸå‰‡ã¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](./CLAUDE-GUIDELINES.md)**
  - å‘½åè¦å‰‡ã®çµ±ä¸€
  - Services vs UseCases: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®é…ç½®æŒ‡é‡
  - å¾ªç’°ä¾å­˜ã‚’é˜²ããŸã‚ã®è¨­è¨ˆåŸå‰‡
  - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã®ãƒªã‚¹ã‚¯è»½æ¸›æ–¹é‡
  - è­¦å‘ŠæŠ‘åˆ¶ã®é‹ç”¨ãƒ«ãƒ¼ãƒ«

- **[Phaseå®Ÿè£…è©³ç´°](./CLAUDE-PHASES.md)**
  - Phase 20-23ã®è©³ç´°ãªå®Ÿè£…æ‰‹é †
  - å„Phaseã®å®Œäº†æ¡ä»¶ã¨æˆåŠŸæŒ‡æ¨™
  - ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã¨ãƒªã‚¹ã‚¯ç®¡ç†
  - ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆã¸ã®ç§»è¡Œæº–å‚™

## ğŸ¯ è¨­è¨ˆåŸå‰‡ã‚µãƒãƒªãƒ¼

### ä¾å­˜é–¢ä¿‚ã®åŸå‰‡
```
handler â†’ service â†’ repository â†’ domain
   â†“         â†“          â†“          â†“
  dto    usecase      dto       (core)
```
- ä¸Šä½å±¤ã¯ä¸‹ä½å±¤ã®ã¿ã«ä¾å­˜
- å¾ªç’°ä¾å­˜ã¯çµ¶å¯¾ã«é¿ã‘ã‚‹
- æ¨ªæ–­çš„é–¢å¿ƒäº‹ã¯sharedãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«é…ç½®

è©³ç´°ã¯[CLAUDE-GUIDELINES.md](./CLAUDE-GUIDELINES.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã«å®Ÿè¡Œå¯èƒ½ãªã‚¿ã‚¹ã‚¯
1. ~~ãƒ¬ã‚¬ã‚·ãƒ¼DTOãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œï¼ˆæ©Ÿæ¢°çš„ä½œæ¥­ï¼‰~~ âœ… å®Œäº†
2. ~~ç©ºã®å†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤~~ âœ… å®Œäº†
3. ~~ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã®ä¸€æ‹¬æ›´æ–°~~ âœ… å®Œäº†
4. ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œï¼ˆPhase 20æ®‹ä½œæ¥­ï¼‰
5. ãƒ¬ã‚¬ã‚·ãƒ¼ãƒªãƒã‚¸ãƒˆãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»è¡Œç¢ºèªï¼ˆPhase 20æ®‹ä½œæ¥­ï¼‰

### æ¤œè¨ãŒå¿…è¦ãªã‚¿ã‚¹ã‚¯
1. Paymentæ©Ÿèƒ½ã®è¨­è¨ˆã¨FeatureåŒ–
2. Useræ©Ÿèƒ½ã®authæ©Ÿèƒ½ã‹ã‚‰ã®åˆ†é›¢æ–¹æ³•
3. ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆã¸ã®ç§»è¡Œæˆ¦ç•¥

### æˆåŠŸæŒ‡æ¨™
- [ ] `api/`, `domain/`, `repository/`, `service/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç©º
- [ ] å…¨æ©Ÿèƒ½ãŒfeaturesãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é…ä¸‹ã«å­˜åœ¨
- [ ] `#[allow(dead_code)]` ãŒ0ä»¶
- [ ] ignoredãƒ†ã‚¹ãƒˆãŒ0ä»¶
- [ ] å„featureãŒç‹¬ç«‹ã—ã¦ãƒ“ãƒ«ãƒ‰å¯èƒ½ï¼ˆå°†æ¥ï¼‰

## ğŸ“ å‚™è€ƒ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ç”ŸããŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é€²è¡Œã«åˆã‚ã›ã¦æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
å„Phaseã®å®Œäº†æ™‚ã«ã¯ã€å®Œäº†æ—¥ã¨ä¸»ãªæˆæœã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

---
æœ€çµ‚æ›´æ–°: 2025-07-11
Phase 21å®Œäº†: æ–°è¦Featureä½œæˆï¼ˆpayment, user, systemï¼‰å®Œäº†ã€ä¸€éƒ¨æ©Ÿèƒ½ã¯éƒ¨åˆ†çš„ãªå®Ÿè£…

## ğŸ”„ æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³å¼•ãç¶™ãæƒ…å ±

### é–‹å§‹æ™‚ã®æŒ‡ç¤º
ã€Œç¶šãã‹ã‚‰ãŠé¡˜ã„ã—ã¾ã™ã€‚ã€ã§OKã§ã™ã€‚

### ç¾åœ¨ã®çŠ¶æ³
- **ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: `task-backend/`å†…ã§ä½œæ¥­ä¸­
- **ãƒ“ãƒ«ãƒ‰çŠ¶æ…‹**: æ­£å¸¸ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ»è­¦å‘Šãªã—ï¼‰
- **ãƒ†ã‚¹ãƒˆçŠ¶æ…‹**: 523 passed, 0 failed, 6 ignored
- **Phase 20é€²æ—**: paymenté–¢é€£ã®ç§»è¡Œå®Œäº†ã€ä»–ã®ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ç§»è¡Œã¯æœªç€æ‰‹
- **Phase 21é€²æ—**: 3ã¤ã®æ–°è¦Featureä½œæˆå®Œäº†ï¼ˆpaymentå®Œå…¨å®Ÿè£…ã€user/systeméƒ¨åˆ†å®Ÿè£…ï¼‰

### æ¬¡ã®ä½œæ¥­å†…å®¹
Phase 22: æ®‹èª²é¡Œã®è§£æ¶ˆ
1. **Phase 20æ®‹ä½œæ¥­ã®å®Œäº†**ï¼ˆå„ªå…ˆåº¦ï¼šé«˜ï¼‰
   - `domain/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®æ®‹ã‚Š19ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é©åˆ‡ãªfeatureã¸ç§»è¡Œ
   - `repository/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®æ®‹ã‚Š14ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é©åˆ‡ãªfeatureã¸ç§»è¡Œ
   - `service/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®æ®‹ã‚Š9ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é©åˆ‡ãªfeatureã¸ç§»è¡Œ
   - `api/handlers/`å†…ã®æ®‹ã‚Šã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’é©åˆ‡ãªfeatureã¸ç§»è¡Œ
   - ç©ºã«ãªã£ãŸãƒ¬ã‚¬ã‚·ãƒ¼ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤

2. **Phase 21æ®‹èª²é¡Œã®è§£æ¶ˆ**ï¼ˆå„ªå…ˆåº¦ï¼šä¸­ï¼‰
   - features/user/ã®å®Œå…¨åŒ–ï¼ˆãƒ¢ãƒ‡ãƒ«ã€ãƒªãƒã‚¸ãƒˆãƒªã€DTOã®æ•´ç†ï¼‰
   - features/system/ã®å®Œå…¨åŒ–ï¼ˆã‚µãƒ¼ãƒ“ã‚¹å±¤ã®å®Ÿè£…ï¼‰
   - æ—¢å­˜featureã®æ§‹é€ è£œå®Œ

3. **Phase 23ã¸ã®æº–å‚™**ï¼ˆå„ªå…ˆåº¦ï¼šä½ï¼‰
   - ignoredãƒ†ã‚¹ãƒˆ6ä»¶ã®ä¿®æ­£è¨ˆç”»
   - dead codeè­¦å‘Šã®èª¿æŸ»

### é”æˆè¦‹è¾¼ã¿
Phase 22ã¯æ®‹èª²é¡Œè§£æ¶ˆã«ç‰¹åŒ–ã—ãŸãƒ•ã‚§ãƒ¼ã‚ºã¨ã—ã¦ã€2-3ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Œäº†å¯èƒ½ã§ã™ã€‚
ç‰¹ã«Phase 20ã®æ®‹ä½œæ¥­ã¯æ©Ÿæ¢°çš„ãªç§»è¡Œä½œæ¥­ãŒä¸­å¿ƒã®ãŸã‚ã€æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å¤§éƒ¨åˆ†ã‚’å®Œäº†ã§ãã‚‹è¦‹è¾¼ã¿ã§ã™ã€‚